
一、SSH 连接：
ssh -i "~/Desktop/Projects/EC2-Common-Key.pem" ubuntu@ec2-34-229-156-60.compute-1.amazonaws.com

ssh -i "~/Desktop/Projects/EC2-Common-Key.pem" ubuntu@ec2-3-95-198-226.compute-1.amazonaws.com

二、更新 部署

docker pull registry.cn-hangzhou.aliyuncs.com/ledouyx/chef-backend:main-ce7065f3

docker stop chef-game-backend
docker rm chef-game-backend

docker run -d --restart=unless-stopped --name chef-game-backend -p 8080:8080 -v /home/ubuntu/chef-backend/data:/app/data -e SPRING_PROFILES_ACTIVE=prd registry.cn-hangzhou.aliyuncs.com/ledouyx/chef-backend:main-ce7065f3

docker logs --tail 100 -f chef-game-backend






三、其他：NFS挂载

数据都放在这台服务器上
ssh -i "~/Desktop/Projects//EC2-Common-Key.pem" ubuntu@ec2-54-159-54-177.compute-1.amazonaws.com

注意，这台服务器需要配置安全组，目前已配置
类型: 所有流量
源: 指向应用服务器的安全组


# 1. 安装 NFS 服务
sudo apt install nfs-kernel-server -y

# 2. 确认目录存在
cd /home/ubuntu
mkdir -p ./chef-backend/data
ls -la /home/ubuntu/chef-backend/data

# 3. 配置共享目录
sudo nano /etc/exports

# 在文件末尾添加这一行（允许应用服务器访问）：
/home/ubuntu/chef-backend/data 172.31.26.79(rw,sync,no_root_squash,no_subtree_check)
/home/ubuntu/chef-backend/data 172.31.19.195(rw,sync,no_root_squash,no_subtree_check)

# 保存并退出：按 Ctrl+X，然后按 Y，然后按 Enter

# 4. 应用配置
sudo exportfs -arv

# 5. 启动 NFS 服务
sudo systemctl enable nfs-kernel-server
sudo systemctl start nfs-kernel-server

# 6. 检查服务状态
sudo systemctl status nfs-kernel-server

# 7. 验证共享配置
sudo exportfs -v

# 8. 检查防火墙（如果有），一般是关闭，不用管
sudo ufw status




ssh -i "~/Desktop/Projects/EC2-Common-Key.pem" ubuntu@ec2-34-229-156-60.compute-1.amazonaws.com

ssh -i "~/Desktop/Projects/EC2-Common-Key.pem" ubuntu@ec2-3-95-198-226.compute-1.amazonaws.com

# 1. 安装 NFS 客户端（应用服务器中执行）
sudo apt install nfs-common -y

# 2. 测试能否看到共享
showmount -e 172.31.18.91

# 3. 挂载
sudo mount -t nfs 172.31.18.91:/home/ubuntu/chef-backend/data /home/ubuntu/chef-backend/data


# 4. 验证挂载成功
df -h 

# 5. 开机自动挂载
echo "172.31.18.91:/home/ubuntu/chef-backend/data /home/ubuntu/chef-backend/data nfs defaults,_netdev 0 0" | sudo tee -a /etc/fstab



特别注意： 挂载问题处理后，必须重新部署 docker restart 一下